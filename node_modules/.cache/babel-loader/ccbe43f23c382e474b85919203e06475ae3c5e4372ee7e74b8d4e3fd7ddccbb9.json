{"ast":null,"code":"import _objectSpread from\"/home/aleksandrakrysinska94/pizzeria/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import{Form,Button,Row,Col}from'react-bootstrap';import{useDispatch}from'react-redux';import{saveTable}from'../../../redux/tablesRedux';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TableDetailsPage=()=>{const{id}=useParams();const navigate=useNavigate();const dispatch=useDispatch();const[table,setTable]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{fetch(\"http://localhost:3131/api/tables/\".concat(id)).then(res=>{if(!res.ok)throw new Error('Not found');return res.json();}).then(data=>{setTable(data);}).catch(err=>{setError(err.message);}).finally(()=>setLoading(false));},[id]);useEffect(()=>{if(table&&(table.status==='Free'||table.status==='Cleaning')){setTable(prev=>_objectSpread(_objectSpread({},prev),{},{peopleAmount:0}));}},[table&&table.status]);if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});if(error){navigate('/');return null;}if(!table)return null;const handleChange=e=>{const{name,value}=e.target;const parsed=name==='status'?value:Number(value);setTable(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:parsed}));};const handleSubmit=async e=>{e.preventDefault();// validations\nif(table.peopleAmount<0)table.peopleAmount=0;if(table.maxPeopleAmount<0)table.maxPeopleAmount=0;if(table.maxPeopleAmount>10)table.maxPeopleAmount=10;if(table.peopleAmount>table.maxPeopleAmount)table.peopleAmount=table.maxPeopleAmount;// if status busy and bill missing -> default 0\nif(table.status==='Busy'&&(table.bill===undefined||table.bill===null)){table.bill=0;}// save to server via thunk\nawait dispatch(saveTable(table));// redirect to home\nnavigate('/');};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-3\",style:{maxWidth:600,margin:'0 auto'},children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Table \",id]}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,className:\"mt-4\",children:[/*#__PURE__*/_jsxs(Form.Group,{as:Row,className:\"mb-3\",controlId:\"formStatus\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,sm:\"2\",children:\"Status:\"}),/*#__PURE__*/_jsx(Col,{sm:\"6\",children:/*#__PURE__*/_jsxs(Form.Select,{name:\"status\",value:table.status,onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"Free\",children:\"Free\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Reserved\",children:\"Reserved\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Busy\",children:\"Busy\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cleaning\",children:\"Cleaning\"})]})})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Row,className:\"mb-3\",controlId:\"formPeople\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,sm:\"2\",children:\"People:\"}),/*#__PURE__*/_jsx(Col,{sm:\"3\",children:/*#__PURE__*/_jsx(Form.Control,{type:\"number\",name:\"peopleAmount\",value:table.peopleAmount,onChange:handleChange,min:\"0\",max:table.maxPeopleAmount})}),/*#__PURE__*/_jsx(Col,{sm:\"1\",className:\"text-center\",children:\"/\"}),/*#__PURE__*/_jsx(Col,{sm:\"3\",children:/*#__PURE__*/_jsx(Form.Control,{type:\"number\",name:\"maxPeopleAmount\",value:table.maxPeopleAmount,onChange:handleChange,min:\"0\",max:\"10\"})})]}),table.status==='Busy'&&/*#__PURE__*/_jsxs(Form.Group,{as:Row,className:\"mb-3\",controlId:\"formBill\",children:[/*#__PURE__*/_jsx(Form.Label,{column:true,sm:\"2\",children:\"Bill:\"}),/*#__PURE__*/_jsx(Col,{sm:\"3\",children:/*#__PURE__*/_jsx(Form.Control,{type:\"number\",name:\"bill\",value:table.bill,onChange:handleChange,min:\"0\"})})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",children:\"Update\"})]})]});};export default TableDetailsPage;","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","Form","Button","Row","Col","useDispatch","saveTable","jsx","_jsx","jsxs","_jsxs","TableDetailsPage","id","navigate","dispatch","table","setTable","loading","setLoading","error","setError","fetch","concat","then","res","ok","Error","json","data","catch","err","message","finally","status","prev","_objectSpread","peopleAmount","children","handleChange","e","name","value","target","parsed","Number","handleSubmit","preventDefault","maxPeopleAmount","bill","undefined","className","style","maxWidth","margin","onSubmit","Group","as","controlId","Label","column","sm","Select","onChange","Control","type","min","max","variant"],"sources":["/home/aleksandrakrysinska94/pizzeria/src/components/pages/TableDetailsPage/TableDetailsPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Form, Button, Row, Col } from 'react-bootstrap';\nimport { useDispatch } from 'react-redux';\nimport { saveTable } from '../../../redux/tablesRedux';\n\nconst TableDetailsPage = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const [table, setTable] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    fetch(`http://localhost:3131/api/tables/${id}`)\n      .then(res => {\n        if (!res.ok) throw new Error('Not found');\n        return res.json();\n      })\n      .then(data => {\n        setTable(data);\n      })\n      .catch(err => {\n        setError(err.message);\n      })\n      .finally(() => setLoading(false));\n  }, [id]);\n\n  useEffect(() => {\n    if (table && (table.status === 'Free' || table.status === 'Cleaning')) {\n      setTable(prev => ({ ...prev, peopleAmount: 0 }));\n    }\n  }, [table && table.status]);\n\n  if (loading) return <p>Loading...</p>;\n  if (error) {\n    navigate('/');\n    return null;\n  }\n  if (!table) return null;\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    const parsed = name === 'status' ? value : Number(value);\n    setTable(prev => ({ ...prev, [name]: parsed }));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    // validations\n    if (table.peopleAmount < 0) table.peopleAmount = 0;\n    if (table.maxPeopleAmount < 0) table.maxPeopleAmount = 0;\n    if (table.maxPeopleAmount > 10) table.maxPeopleAmount = 10;\n    if (table.peopleAmount > table.maxPeopleAmount) table.peopleAmount = table.maxPeopleAmount;\n\n    // if status busy and bill missing -> default 0\n    if (table.status === 'Busy' && (table.bill === undefined || table.bill === null)) {\n      table.bill = 0;\n    }\n\n    // save to server via thunk\n    await dispatch(saveTable(table));\n\n    // redirect to home\n    navigate('/');\n  };\n\n  return (\n    <div className=\"p-3\" style={{ maxWidth: 600, margin: '0 auto' }}>\n      <h2>Table {id}</h2>\n      <Form onSubmit={handleSubmit} className=\"mt-4\">\n        <Form.Group as={Row} className=\"mb-3\" controlId=\"formStatus\">\n          <Form.Label column sm=\"2\">Status:</Form.Label>\n          <Col sm=\"6\">\n            <Form.Select name=\"status\" value={table.status} onChange={handleChange}>\n              <option value=\"Free\">Free</option>\n              <option value=\"Reserved\">Reserved</option>\n              <option value=\"Busy\">Busy</option>\n              <option value=\"Cleaning\">Cleaning</option>\n            </Form.Select>\n          </Col>\n        </Form.Group>\n\n        <Form.Group as={Row} className=\"mb-3\" controlId=\"formPeople\">\n          <Form.Label column sm=\"2\">People:</Form.Label>\n          <Col sm=\"3\">\n            <Form.Control\n              type=\"number\"\n              name=\"peopleAmount\"\n              value={table.peopleAmount}\n              onChange={handleChange}\n              min=\"0\"\n              max={table.maxPeopleAmount}\n            />\n          </Col>\n          <Col sm=\"1\" className=\"text-center\">/</Col>\n          <Col sm=\"3\">\n            <Form.Control\n              type=\"number\"\n              name=\"maxPeopleAmount\"\n              value={table.maxPeopleAmount}\n              onChange={handleChange}\n              min=\"0\"\n              max=\"10\"\n            />\n          </Col>\n        </Form.Group>\n\n        {table.status === 'Busy' && (\n          <Form.Group as={Row} className=\"mb-3\" controlId=\"formBill\">\n            <Form.Label column sm=\"2\">Bill:</Form.Label>\n            <Col sm=\"3\">\n              <Form.Control\n                type=\"number\"\n                name=\"bill\"\n                value={table.bill}\n                onChange={handleChange}\n                min=\"0\"\n              />\n            </Col>\n          </Form.Group>\n        )}\n\n        <Button type=\"submit\" variant=\"primary\">Update</Button>\n      </Form>\n    </div>\n  );\n};\n\nexport default TableDetailsPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}